import xarray as xr
import os
import torch
import numpy as np
import sys
import matplotlib.pyplot as plt
sys.path.append('/home/eastinev/AI')
import paths as pth

def main():
    X4_spr = np.array([7.83847852e-03, 7.91313881e-03, 7.72418873e-03, 7.28557185e-03,
      6.74742244e-03, 6.22740478e-03, 6.03661697e-03, 5.53028453e-03,
      4.55347498e-03, 3.61838909e-03, 2.32395265e-03, 1.84744809e-03,
      1.03849726e-03, 7.28940875e-04, 4.70956333e-04, 2.73123213e-04,
      1.35967783e-04, 4.93160971e-05, 1.22455604e-05, 3.11634729e-06,
      2.51658853e-06, 2.52327985e-06, 2.56239591e-06, 2.57742230e-06,
      2.57396944e-06, 2.59050079e-06, 2.60668380e-06, 2.65282159e-06])

    CTRL_spr = np.array([5.76009302e-03, 6.12622463e-03, 6.12444958e-03, 5.73395512e-03,
      5.23098193e-03, 4.72097871e-03, 4.63150382e-03, 4.15826152e-03,
      3.32419532e-03, 2.49230272e-03, 1.49754308e-03, 1.13114841e-03,
      5.68907831e-04, 3.79095589e-04, 2.30000709e-04, 1.22666678e-04,
      5.53428196e-05, 1.76158063e-05, 4.49909656e-06, 1.98405725e-06,
      1.91596537e-06, 1.97305752e-06, 1.97316780e-06, 1.96249853e-06,
      1.97939008e-06, 2.04533644e-06, 2.08116857e-06, 2.16728041e-06])

    X4 = np.array([9.74943837e-03, 9.77987587e-03, 1.01915238e-02, 9.40840919e-03,
      8.59197629e-03, 8.02911931e-03, 7.96854553e-03, 7.33304002e-03,
      6.39306294e-03, 5.26683555e-03, 3.71662142e-03, 2.96664173e-03,
      1.64770984e-03, 1.12132823e-03, 7.01317321e-04, 3.94852845e-04,
      1.90354865e-04, 6.56223818e-05, 1.47702790e-05, 3.67921644e-06,
      2.81767304e-06, 2.65735135e-06, 2.58028413e-06, 2.56668266e-06,
      2.60065759e-06, 2.67377034e-06, 2.71517823e-06, 2.84062724e-06])

    CTRL = np.array([7.20951333e-03, 7.78888466e-03, 8.41265116e-03, 8.06080640e-03,
      7.46709069e-03, 6.87201466e-03, 6.81319910e-03, 6.15797141e-03,
      5.15741369e-03, 4.08010326e-03, 2.66566012e-03, 2.00630699e-03,
      9.23541358e-04, 6.03186529e-04, 3.58109478e-04, 1.87683150e-04,
      8.36785631e-05, 2.47876755e-05, 5.37139719e-06, 2.27833082e-06,
      2.04118565e-06, 1.96255885e-06, 1.95850584e-06, 1.97623303e-06,
      2.01531305e-06, 2.09383218e-06, 2.14166987e-06, 2.28474423e-06])

    # Temperature profile
    T_CTRL_sum = np.array([287.98317472, 287.52229116, 286.59800871, 285.64081197, 284.63523894,
      283.691521,   282.82962645, 281.74402324, 279.36802511, 274.85401825,
      267.98604078, 264.07037759, 254.46705189, 248.22501593, 241.17520239,
      233.35238673, 225.57455721, 219.66708223, 214.44079178, 209.920505,
      211.41463374, 214.91390635, 217.39888025, 220.89452215, 225.90750962,
      234.79678512, 240.33824201, 257.83107645])

    T_X4_sum = np.array([289.31329084, 288.29824261, 287.4616588,  286.73468277, 285.93311839,
      285.17838322, 284.48737505, 283.54373071, 281.57850791, 277.76132023,
      271.48535927, 267.99315841, 259.298727,   253.55542357, 247.05340211,
      239.70812004, 231.92935317, 225.02451487, 219.48258515, 213.91107545,
      213.46589742, 216.49038382, 218.98312565, 222.50832055, 227.57327543,
      236.42512739, 241.88712903, 259.14505649])

    T_X4_spr = np.array([280.41815684, 279.49162802, 278.79760173, 278.20832702, 277.65174339,
      277.16811895, 276.72069212, 276.07949643, 274.6384977,  271.43533943,
      265.84784787, 262.47148509, 254.02573281, 248.60989908, 242.51598463,
      235.87908881, 229.20172157, 223.26606466, 217.83508373, 211.56639228,
      209.61058954, 212.35599504, 214.97512331, 218.14691734, 222.50520374,
      230.88224448, 236.07738244, 251.52907129])

    T_CTRL_spr = np.array([280.21660109, 279.56487641, 278.69380484, 277.89356945, 277.1516487,
      276.46553891, 275.79728115, 274.91153574, 272.91767686, 268.83000089,
      262.23362049, 258.22649303, 248.59268178, 242.63374702, 236.17935591,
      229.48678732, 223.40842873, 218.75044297, 213.85049842, 208.41252693,
      208.41301714, 211.9889367,  214.62856569, 217.96096373, 222.48677246,
      230.80907428, 235.93524454, 251.42922827])

    LEV = np.array([
        1000, 975, 950, 925, 900, 875, 850,
        825, 775, 700, 600, 550, 450, 400, 350, 300,
        250, 200, 150, 100, 70, 
        50, 40, 30, 20, 10, 7, 3
    ])
    
    ab = CTRL / X4
    print(ab)
    bb = CTRL_spr / X4_spr
    print(bb)
    return

    qdiff_sum = (X4 - CTRL) / CTRL * 100
    print('summer precent difference', qdiff_sum)
    qdiff_spr = (X4_spr - CTRL_spr) / CTRL_spr * 100
    print('spring precent difference', qdiff_spr)
    tdiff_sum = (T_X4_sum - T_CTRL_sum)
    tdiff_spr = (T_X4_spr - T_CTRL_spr)
    print('summer T diff', tdiff_sum)
    print('spring T diff', tdiff_spr)
    return

    fig, ax = plt.subplots(1, 2)
    ax[0].plot(T_CTRL_sum, LEV, 'k', label='CTRL')
    ax[0].plot(T_X4_sum, LEV, 'b', label='4X')
    ax[0].invert_yaxis()
    ax[0].legend()
    ax[1].plot(T_CTRL_spr, LEV, 'k')
    ax[1].plot(T_X4_spr, LEV, 'b')
    ax[1].invert_yaxis()
    plt.savefig('./tvert.png')
    return

    ff = '/projects/bccg/Data/REANA/MERRA2/M2I3NPASM/MERRA2_300.inst3_3d_asm_Np.20020714.nc4'  # MERRA2_200.inst3_3d_asm_Np.19990403.nc4'
    a = '1992084.03.nc' # '2008118.21.nc'
    f = os.path.join(pth.MSWEP, a)
    ds = xr.open_dataset(ff)
    print(ds)

if __name__ == '__main__':
    main()
